#!/bin/sh
lang="${1-de}"
grep -v "^#" "${lang}.txt" |
while read nr text
do
	if fgrep -q "${nr} ${text}" en.txt
	then
		continue
	fi
	en=`grep "^${nr} " en.txt`
	en="${en#* }"
	echo "s+${en}+${text}+" >> "${lang}.sed"
done
for c in src/iroffer*.c
do
	sed -f "${lang}.sed" "${c}" > "${c}.new"
	if diff -q "${c}" "${c}.new"
	then
		rm -f "${c}.new"
		continue
	fi
	if test ! -f "${c}.en"
	then
		echo \
		mv -i "${c}" "${c}.en"
		mv -i "${c}" "${c}.en"
	else
		echo \
		rm -f "${c}"
		rm -f "${c}"
	fi
	echo \
	mv -i "${c}.new" "${c}"
	mv -i "${c}.new" "${c}"
	rm -f "${c}.new"
done
# eof
